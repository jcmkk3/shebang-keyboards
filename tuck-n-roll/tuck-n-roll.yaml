points:
  rotate: 0
  zones:
    matrix:
      columns:
        pinky:
          origin: [ 0, -17 ]
          rotate: 19  # 19 degrees
          stagger: 0 # affects distance to previous column so useless for a left pinky column
          spread: 0 # affects distance to previous column so useless for a left pinky column
          rows:
            bottom:
              bind: [ 5, 0, 0, 0 ]
              column_net: P7
            home:
              bind: [ 0, 12, 0, 0 ]
              column_net: P6
            top:
              bind: [ 0, 8, 5, 0 ]
              column_net: P5
        ring:
          origin: [ 0, -17 ]
          rotate: -4 # 15 degrees
          stagger: 10
          spread: 23
          rows:
            bottom:
              bind: [ 0, 0, 2, 10 ]
              column_net: P4
            home:
              bind: [ 5, 0, 5, 0 ]
              column_net: P3
            top:
              bind: [ 0, 5, 0, 0 ]
              column_net: P0
        middle:
          origin: [ 0, -17 ]
          rotate: -10 # 5 degrees
          stagger: -1
          spread: 18
          rows:
            bottom:
              bind: [ 0, 10, 0, 5 ]
              column_net: P1
            home:
              bind: 5
              column_net: P19
            top:
              bind: [ 0, 0, 0, 0 ]
              column_net: P18
        index:
          origin: [ 0, -17 ]
          rotate: -5 # 0 degrees
          stagger: -3
          spread: 20
          rows:
            bottom:
              bind: [ 0, 5, 0, 0 ]
              column_net: P15
            home:
              bind: [ 5, 0, 5, 0 ]
              column_net: P14
            top:
              bind: [ 0, 0, 0, 6 ]
              column_net: P16
        inner:
          origin: [ 0, -17 ]
          rotate: 0
          stagger: -1
          rows:
            bottom:
              bind: [ 5, 19, 20, 2 ]
              column_net: P10
            home:
              bind: [ 0, 27, 0, 5 ]
              column_net: P20
            top:
              bind: [ 0, 0, 5, 5 ]
              column_net: P21
      rows:
        # Choc Y spacing 17mm
        # NOTE: added .1mm to stop keycap outlines from merging
        bottom:
          padding: 17.1
        home:
          padding: 17.1
        top:
          padding: 17.1
      key:
        footprints:
          choc_hotswap:
            type: choc
            nets:
              from: =column_net
              to: GND
            params:
              keycaps: true
              reverse: true
              hotswap: true
          choc:
            type: choc
            anchor:
              rotate: 180
            nets:
              from: =column_net
              to: GND
            params:
              keycaps: true
              reverse: true
    thumbfan:
      anchor:
        ref: matrix_inner_bottom
        shift: [ -3, -22 ]
      columns:
        near:
          rotate: -15
          rows:
            thumb:
              column_net: P8
              bind: [ 10, 1, 0, 70 ]
        home:
          spread: 19
          rotate: -10 # -25 degrees cumulative
          origin: [-9.5, -9]
          rows:
            thumb:
              column_net: P9
              bind: [ 10, 1, 0, 70 ]
        far:
          spread: 19
          rotate: -10 # 35 degrees cumulative
          origin: [-9.5, -9]
          rows:
            thumb:
              column_net: P10
              bind: [ 10, 1, 0, 70 ]
      rows:
        thumb:
          padding: 0
      key:
        footprints:
          choc_hotswap:
            type: choc
            nets:
              from: =column_net
              to: GND
            params:
              keycaps: true
              reverse: true
              hotswap: true
          choc:
            type: choc
            anchor:
              rotate: 180
            nets:
              from: =column_net
              to: GND
            params:
              keycaps: true
              reverse: true
outlines:
  exports:
    raw:
      - type: keys
        side: left
        size: [18,17]
        corner: 1
      - type: polygon
        points:
          - ref: matrix_pinky_bottom
            shift: [ -10 , -30 ]
          - ref: matrix_pinky_top
            shift: [ -10, 16 ]
          - ref: matrix_middle_top
            shift: [ -9, 14 ]
          - ref: matrix_inner_top
            shift: [ 25, 13 ]
          - ref: matrix_inner_top
            shift: [ 45, 0 ]
          - ref: matrix_inner_bottom
            shift: [ 50, -38 ]
          #- ref: thumbfan_far_thumb
          #  shift: [ 10, 9 ] # top right of keycap
          - ref: thumbfan_far_thumb
            shift: [ 10, -9 ] # bottom right of keycap
        operation: add
    panel:
      - type: outline
        name: raw
        fillet: 0.5
    switch_cutouts:
      - type: keys
        side: left
        size: 14
        bound: false
    keycap_outlines:
      - type: keys
        side: left
        size: [18, 17]
        bound: false
    switch_plate:
      main:
        type: outline
        name: raw
        fillet: 0.5
      keyholes:
        type: outline
        name: switch_cutouts
        operation: subtract
    choc_caps_plate:
      main:
        type: outline
        name: raw
        fillet: 0.5
      keycaps:
        type: outline
        name: keycap_outlines
        operation: subtract
pcbs:
  alpha:
    outlines:
      main:
        outline: panel
    footprints:
      promicro:
        type: promicro
        anchor:
          ref: matrix_inner_home
          shift: [19, -8.5]
          rotate: -90
        params:
          orientation: down
      jstph:
        type: jstph
        nets:
          pos: 5V #TODO
          neg: GND
        params:
          side: B
cases:
  switchplate:
    - type: outline # default option
      name: switch_plate
      extrude: 1.2 # mm, choc MX
      shift: [ 0, 0, 0 ] # [x, y, z]
      rotate: [ 0, 0, 0 ] # [ax, ay, az]
      operation: add # add | subtract | intersect # default = add